### ESlintã€Prettierã€TypeScript

```sh
npm i -D eslint @typescript-eslint/parser  eslint-plugin-react
npm i -D prettier eslint-config-prettier eslint-plugin-prettier
```

- eslint: ESLintçš„æ ¸å¿ƒä»£ç 

- @typescript-eslint/parserï¼šESLintçš„è§£æå™¨ï¼Œç”¨äºè§£ætypescriptï¼Œä»è€Œæ£€æŸ¥å’Œè§„èŒƒTypescriptä»£ç 

- @typescript-eslint/eslint-pluginï¼šè¿™æ˜¯ä¸€ä¸ªESLintæ’ä»¶ï¼ŒåŒ…å«äº†å„ç±»å®šä¹‰å¥½çš„æ£€æµ‹Typescriptä»£ç çš„è§„èŒƒï¼Œeslint-plugin-prettierå·²è¦†ç›–ï¼Œæ— éœ€å®‰è£…

- eslint-plugin-reactï¼šæ”¯æŒReactè¯­æ³•çš„ESlintæ’ä»¶

- prettierï¼šprettier æ’ä»¶çš„æ ¸å¿ƒä»£ç 

- eslint-config-prettierï¼šè§£å†³ESLintä¸­çš„æ ·å¼è§„èŒƒå’Œprettierä¸­æ ·å¼è§„èŒƒçš„å†²çªï¼Œä»¥prettierçš„æ ·å¼è§„èŒƒä¸ºå‡†ï¼Œä½¿ESLintä¸­çš„æ ·å¼è§„èŒƒè‡ªåŠ¨å¤±æ•ˆã€‚

- eslint-plugin-prettierï¼šå°†prettierçš„è§„åˆ™ä½œä¸ºESLintè§„åˆ™æ¥ä½¿ç”¨ï¼Œå› æ­¤éœ€è¦å®‰è£… prettierã€‚
  
  è¯¥æ’ä»¶å…ˆä½¿ç”¨prettierå¯¹ä½ çš„ä»£ç è¿›è¡Œæ ¼å¼åŒ–ï¼Œç„¶åä¸æ ¼å¼åŒ–ä¹‹å‰çš„ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœè¿‡å‡ºç°äº†ä¸ä¸€è‡´ï¼Œè¿™ä¸ªåœ°æ–¹å°±ä¼šè¢«prettierè¿›è¡Œæ ‡è®°ã€‚
  
  æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨rulesä¸­æ·»åŠ ï¼Œ`"prettier/prettier": "error"`ï¼Œè¡¨ç¤ºè¢«prettieræ ‡è®°çš„åœ°æ–¹æŠ›å‡ºé”™è¯¯ä¿¡æ¯ã€‚ç„¶åå€ŸåŠ©`eslint --fix`å°†æŠ›å‡ºerrorçš„åœ°æ–¹è¿›è¡Œfixã€‚
  
  ```js
  // å¦‚æœå·²åœ¨extendsæ·»åŠ äº†æ’ä»¶çš„é…ç½®æ–¹æ¡ˆï¼Œåˆ™ä¸éœ€è¦é‡å¤æ·»åŠ  "prettier/prettier": "error"
  extends: [ 
      'plugin:prettier/recommended',
  ],
  rules:{
      // "prettier/prettier": "error"
  }
  ```

- > [eslint-config-prettier](https://github.com/prettier/eslint-config-prettier/blob/6537dd961a7b612d6104017234024f241c2b7591/CHANGELOG.md)
  > 
  > Changed: All configs have been merged into one!
  > 
  > To upgrade, change:
  > 
  > ```js
  > {
  >     "extends": [
  >        "some-other-config-you-use",
  >        "prettier",
  >        "prettier/@typescript-eslint",
  >        "prettier/babel",
  >        "prettier/flowtype",
  >        "prettier/react",
  >        "prettier/standard",
  >        "prettier/unicorn",
  >        "prettier/vue"
  >     ]
  > }
  > ```
  > 
  > Into:
  > 
  > ```js
  > {
  >     "extends": [
  >        "some-other-config-you-use",
  >        "prettier"
  >     ]
  > }
  > ```
  > 
  > If you use [eslint-plugin-prettier](https://github.com/prettier/eslint-plugin-prettier), all you need is [plugin:prettier/recommended](https://github.com/prettier/eslint-plugin-prettier#recommended-configuration):
  > 
  > ```js
  > {
  >     "extends": [
  >        "some-other-config-you-use",
  >        "plugin:prettier/recommended"
  >     ]
  > }
  > ```

#### .eslintrc.js å¸¸ç”¨é…ç½®

[rules](https://eslint.bootcss.com/docs/rules/)

```js
module.exports = {
    parser:  '@typescript-eslint/parser', //å®šä¹‰ESLintçš„è§£æå™¨
    // extendså¯çœç•¥å‰ç¼€ eslint-config-
    // pluginså¯çœç•¥å‰ç¼€ eslint-plugin-
    // extendsä½¿ç”¨æ’ä»¶å¯¼å‡ºçš„configï¼Œåˆ æ‰æ’ä»¶å‰ç¼€ååŠ ä¸Šå‰ç¼€plugin:
    extends: [ // ç»§æ‰¿çš„è§„åˆ™ï¼Œåé¢è¦†ç›–å‰é¢
      'plugin:react/recommended', 
      'plugin:prettier/recommended',
    ],
    plugins: [
      // plugin:prettier/recommended çš„ config å·²åŒ…å«ä»¥ä¸‹plugins
      // "react",
      // '@typescript-eslint',
    ],
      parserOptions: {  // è§£æå™¨é€‰é¡¹
      "ecmaVersion": 2019, // æ”¯æŒ ES6 è¯­æ³•å¹¶ä¸æ„å‘³ç€åŒæ—¶æ”¯æŒæ–°çš„ ES6 å…¨å±€å˜é‡æˆ–ç±»å‹ï¼ˆæ¯”å¦‚ Set ç­‰æ–°ç±»å‹ï¼‰ï¼Œéœ€{ "env":{ "es6": true } }
      "sourceType": "module", //  "script" (é»˜è®¤)ï¼Œå¦‚æœä»£ç æ˜¯ ECMAScript æ¨¡å—ï¼Œè®¾ç½®ä¸º"module"
      "ecmaFeatures": {
        "jsx": true
      }
    },
    env:{                          // æŒ‡å®šä»£ç çš„è¿è¡Œç¯å¢ƒ
        browser: true,
          es6:true,
        node: true,
    },
    // å…¨å±€å˜é‡
    globals:{
       "var1": "writable",
       "var2": "readonly",
       "var3": "off", // ç¦ç”¨
    },
  settings: {             
      // eslint-plugin-reactè¦æ±‚ï¼šhttps://www.npmjs.com/package/eslint-plugin-react
      "react": {
        "pragma": "React",
        "version": "detect"
      }
    }, 
    // æ‰©å±•ï¼ˆæˆ–è¦†ç›–ï¼‰è§„åˆ™
    rules: {},
    // è¦†ç›–æŒ‡å®šæ–‡ä»¶ç±»å‹çš„rules
    overrides: [
      {
            "files": ["./src/**/*.html"],
            "rules": {

            }
        }
    ]
}
```

#### .prettierrc.js å¸¸ç”¨é…ç½®

https://prettier.io/docs/en/options.html

å¯ä»¥æŸ¥çœ‹vscode è®¾ç½®->æ‰©å±•-> prettierï¼Œä¸­æ–‡è§£é‡Š

```js
module.exports = {
  printWidth: 120, // è¡Œé•¿
  tabWidth: 2, // ç¼©è¿›é•¿åº¦
  useTabs: false, // ä½¿ç”¨ç©ºæ ¼ä»£æ›¿tabç¼©è¿›
  semi: true, // ç»“å°¾åˆ†å·
  singleQuote: true, // å•å¼•å·ï¼Œjsxå¿½ç•¥æ­¤é€‰é¡¹ï¼Œè¯·ä½¿ç”¨ jsxSingleQuote
  quoteProps: 'preserve', // <as-needed|consistent|preserve> æ˜¯å¦ç»™å¯¹è±¡å±æ€§åŠ å¼•å· preserveï¼šä¿ç•™ç¼–ç¨‹æ—¶çš„çŠ¶æ€
  jsxSingleQuote: false, // jsxä¸­ä½¿ç”¨å•å¼•å·
  trailingComma: 'all', // <es5|none|all> åœ¨å¯¹è±¡æˆ–æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ åé¢æ˜¯å¦åŠ é€—å·ã€‚all å°½å¯èƒ½å°¾éšé€—å·
  bracketSpacing: true, // åœ¨å¯¹è±¡å‰åæ·»åŠ ç©ºæ ¼-eg: { foo: bar }
  bracketSameLine: false, // å¤šå±æ€§htmlã€jsxæ ‡ç­¾çš„â€˜>â€™æŠ˜è¡Œæ”¾ç½®
  arrowParens: 'avoid', // <always|avoid> avoidï¼šå•å‚æ•°ç®­å¤´å‡½æ•°å‚æ•°ä¸ä½¿ç”¨åœ†æ‹¬å·
  endOfLine: 'lf', // ç»“æŸè¡Œå½¢å¼
  embeddedLanguageFormatting: 'auto', // å¯¹å¼•ç”¨ä»£ç è¿›è¡Œæ ¼å¼åŒ–
  overrides: [
    // {
    //   files: '*.test.js',
    //   options: {
    //     semi: true,
    //   },
    // },
    // {
    //   files: ['*.html', 'legacy/**/*.js'],
    //   options: {
    //     tabWidth: 4,
    //   },
    // },
  ],
};
```

**.eslintignore**

globæ¨¡å¼

ESLintæ€»æ˜¯å¿½ç•¥ `/node_modules/*` å’Œ `/bower_components/*` ä¸­çš„æ–‡ä»¶ã€‚

```
dist
!build/index.js
```

å¦‚æœç›¸æ¯”äºå½“å‰å·¥ä½œç›®å½•ä¸‹ `.eslintignore` æ–‡ä»¶ï¼Œä½ æ›´æƒ³ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„æ–‡ä»¶ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä½¿ç”¨ `--ignore-path` é€‰é¡¹æŒ‡å®šå®ƒã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ `.jshintignore` æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæœ‰ç›¸åŒçš„æ ¼å¼ï¼š

```
eslint --ignore-path .jshintignore file.js
```

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä½ çš„ `.gitignore` æ–‡ä»¶ï¼š

```
eslint --ignore-path .gitignore file.js
```

ä»»ä½•æ–‡ä»¶åªè¦æ»¡è¶³æ ‡å‡†å¿½ç•¥æ–‡ä»¶æ ¼å¼éƒ½å¯ä»¥ç”¨ã€‚è®°ä½ï¼ŒæŒ‡å®š `--ignore-path` æ„å‘³ç€ä»»ä½•ç°æœ‰çš„ `.eslintignore` æ–‡ä»¶å°†ä¸è¢«ä½¿ç”¨ã€‚è¯·æ³¨æ„ï¼Œ`.eslintignore` ä¸­çš„åŒ¹é…è§„åˆ™æ¯” `.gitignore` ä¸­çš„æ›´ä¸¥æ ¼ã€‚****

**.prettierignore**

å¦‚æœæ²¡æœ‰ç”¨ prettier æˆ– æ’ä»¶å»ä¿®æ”¹ï¼Œå¯ä»¥ä¸ç”¨è¯¥æ–‡ä»¶

```
dist
!build/index.js
node_moduls
```

#### extendså’Œpluginsçš„åŒºåˆ«

##### plugins

pluginæ’ä»¶ä¸»è¦æ˜¯ä¸ºeslintæ–°å¢ä¸€äº›æ£€æŸ¥è§„åˆ™ï¼Œå¼•å…¥ plugin å¯ä»¥ç†è§£ä¸ºåªæ˜¯åŠ è½½äº†æ’ä»¶ï¼Œå¼•å…¥äº†é¢å¤–çš„ è‡ªå®šä¹‰çš„rulesã€‚éœ€è¦åœ¨ rulesã€extends ä¸­å®šä¹‰åæ‰ä¼šç”Ÿæ•ˆï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸ç”Ÿæ•ˆã€‚

pluginç±»ä¼¼é…ç½®å¥½çš„.eslintrc.jsï¼Œå› æ­¤è¿™éƒ¨åˆ†å¯ä»¥åœ¨extendsé‡Œé…ç½®ï¼šplugin:configåç§°ã€‚

##### extends

extendså¯ä»¥çœ‹åšæ˜¯é›†æˆä¸€ä¸ªä¸ªé…ç½®æ–¹æ¡ˆçš„æœ€ä½³å®è·µã€‚å®ƒå…è®¸é…ç½®å¤šä»½åˆ«äººé…ç½®å¥½çš„.eslintrc.jsã€‚

å…è®¸ extends é…ç½®å¤šä¸ªæ¨¡å—ï¼Œå¦‚æœè§„åˆ™å†²çªï¼Œä½ç½®é åçš„åŒ…å°†è¦†ç›–å‰é¢çš„ã€‚rules ä¸­çš„è§„åˆ™ç›¸åŒï¼Œå¹¶ä¸”ä¼˜å…ˆçº§æ’å®šé«˜äº extendsï¼Œç±»ä¼¼classçš„extendsï¼Œæ”¯æŒå¤šç»§æ‰¿ã€‚

**å‘½åè§„èŒƒ**

extends çš„æ¨¡å—åç§°ä»¥ eslint-config- å¼€å¤´ï¼Œä¾‹å¦‚ eslint-config-myconfigã€‚ä¹Ÿæ”¯æŒ npm ä½œç”¨åŸŸæ¨¡å—ï¼Œä¾‹å¦‚ ï¼š @scope/eslint-config æˆ– @scope/eslint-config-myconfigï¼‰ ã€‚ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç”¨å…¨ç§°ï¼ˆslint-config-myconfigï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨ç¼©å†™ï¼ˆmyconfigï¼‰ã€‚

å¦‚æœ extends å¼•ç”¨äº† plugin çš„configï¼Œplugins ä¸­ä¼šè‡ªåŠ¨å¼•å…¥è¯¥pluginï¼Œå³ä½¿ plugins æ²¡æœ‰æ˜¾å¼å£°æ˜ã€‚

[You have done it correctly.](https://stackoverflow.com/questions/61528185/eslint-extends-vs-plugins-v2020)

For your example, there are 2 ways to do add `typescript-eslint`...

- 1st way:

```js
{
  parser: "@typescript-eslint/parser",
  parserOptions: { sourceType: "module" },
  plugins: ["@typescript-eslint"],
  extends: [],
  rules: {
    "@typescript-eslint/explicit-function-return-type": [
      "error",
      {
        allowExpressions: true
      }
    ]
  }
}
```

- 2nd way:

```js
{
  plugins: [],
  extends: ["plugin:@typescript-eslint/recommended"],
  rules: {
    "@typescript-eslint/explicit-function-return-type": [
      "error",
      {
        allowExpressions: true
      }
    ]
  }
}
```

The difference is...

- 1st way:
  - `parser`, `parserOptions` and `plugins` are manually added,
  - Only `@typescript-eslint/explicit-function-return-type` is enforced.
- 2nd way:
  - `plugin:@typescript-eslint/recommended` has automatically added `parser`, `parserOptions` and `plugins`.  extendså¼•ç”¨äº†pluginçš„configï¼Œå³ä½¿pluginsä¸­æ²¡æœ‰æ˜¾å¼å¼•å…¥ï¼Œä¹Ÿä¼šè‡ªåŠ¨å¼•å…¥
  - `@typescript-eslint/explicit-function-return-type` is augmented and enforced.

#### rules

**ä¼˜å…ˆçº§æœ€é«˜**

- `"off"` æˆ– `0` - å…³é—­è§„åˆ™
- `"warn"` æˆ– `1` - å¼€å¯è§„åˆ™ï¼Œä½¿ç”¨è­¦å‘Šçº§åˆ«çš„é”™è¯¯ï¼š`warn` (ä¸ä¼šå¯¼è‡´ç¨‹åºé€€å‡º)
- `"error"` æˆ– `2` - å¼€å¯è§„åˆ™ï¼Œä½¿ç”¨é”™è¯¯çº§åˆ«çš„é”™è¯¯ï¼š`error` (å½“è¢«è§¦å‘çš„æ—¶å€™ï¼Œç¨‹åºä¼šé€€å‡º)

`rules` å±æ€§å¯ä»¥åšä¸‹é¢çš„ä»»ä½•äº‹æƒ…ä»¥æ‰©å±•ï¼ˆæˆ–è¦†ç›–ï¼‰è§„åˆ™ï¼š

- å¯ç”¨é¢å¤–çš„è§„åˆ™
- æ”¹å˜ç»§æ‰¿çš„è§„åˆ™çº§åˆ«è€Œä¸æ”¹å˜å®ƒçš„é€‰é¡¹ï¼š
  - åŸºç¡€é…ç½®ï¼š`"eqeqeq": ["error", "allow-null"]`  ä¸‰ç­‰äºå·
  - æ´¾ç”Ÿçš„é…ç½®ï¼š`"eqeqeq": "warn"`
  - æœ€åç”Ÿæˆçš„é…ç½®ï¼š`"eqeqeq": ["warn", "allow-null"]`
- è¦†ç›–åŸºç¡€é…ç½®ä¸­çš„è§„åˆ™çš„é€‰é¡¹
  - åŸºç¡€é…ç½®ï¼š`"quotes": ["error", "single", "avoid-escape"]`
  - æ´¾ç”Ÿçš„é…ç½®ï¼š`"quotes": ["error", "single"]`
  - æœ€åç”Ÿæˆçš„é…ç½®ï¼š`"quotes": ["error", "single"]`

åŸºç¡€é…ç½®ï¼šæ•°ç»„ç±»å‹ï¼Œæ´¾ç”Ÿé…ç½®ï¼šå­—ç¬¦ä¸²ç±»å‹ï¼Œæœ€åç±»å‹ï¼šè¦†ç›–æ•°ç»„ç¬¬ä¸€é¡¹ï¼Œ"error"å’Œ"warn"æ˜¯åŒä¸€ç±»å‹ï¼Œéƒ½æ˜¯æ”¾åœ¨æ•°ç»„ç¬¬ä¸€ä½ã€‚å¦‚æœæ´¾ç”Ÿé…ç½®æ˜¯`"eqeqeq": "always"`ï¼Œåˆ™æœ€åç±»å‹ï¼š`"eqeqeq": ["warn", "always"]`

åŸºç¡€é…ç½®ï¼šæ•°ç»„ç±»å‹ï¼Œæ´¾ç”Ÿé…ç½®ï¼šæ•°ç»„ç±»å‹ï¼Œæœ€åç±»å‹ï¼šè¦†ç›–æ•°ç»„ã€‚

#### eslintæ–‡ä»¶å†…å¿½ç•¥è§„åˆ™

https://eslint.org/docs/user-guide/configuring/rules#using-configuration-comments-1

##### å°†/* eslint-disable */æ”¾ç½®äºæ–‡ä»¶æœ€é¡¶éƒ¨

```js
/* eslint-disable */
alert('foo');
```

##### åœ¨æ–‡ä»¶ä¸­ä¸´æ—¶ç¦æ­¢è§„åˆ™å‡ºç°è­¦å‘Š

å°†éœ€è¦å¿½ç•¥çš„ä»£ç å—ç”¨æ³¨é‡ŠåŒ…è£¹èµ·æ¥

```js
/* eslint-disable */
alert('foo');
/* eslint-enable */
```

##### å¯¹æŒ‡å®šè§„åˆ™çš„å¯ç”¨æˆ–è€…ç¦ç”¨è­¦å‘Š

å°†éœ€è¦å¿½ç•¥çš„ä»£ç å—ç”¨æ³¨é‡ŠåŒ…è£¹èµ·æ¥

```js
/* eslint-disable no-alert, no-console */
alert('foo');
console.log('bar');
/* eslint-enable no-alert, no-console */
```

##### å¯¹æŒ‡å®šè¡Œç¦ç”¨è§„åˆ™è­¦å‘Š

æ­¤æ–¹æ³•ï¼Œæœ‰ä¸¤ç§å½¢å¼

```js
alert('foo'); // eslint-disable-line

// or

// eslint-disable-next-line
alert('foo');
```

##### åœ¨æŒ‡å®šè¡Œä¸Šç¦ç”¨æŒ‡å®šçš„æŸä¸ªè§„åˆ™

```js
alert('foo'); // eslint-disable-line no-alert

// eslint-disable-next-line no-alert
alert('foo');
```

##### åœ¨æŸä¸ªç‰¹å®šçš„è¡Œä¸Šç¦ç”¨å¤šä¸ªè§„åˆ™

```js
alert('foo'); // eslint-disable-line no-alert, quotes, semi

// eslint-disable-next-line no-alert, quotes, semi
alert('foo');
```

#### prettier æ–‡ä»¶å†…å¿½ç•¥

https://prettier.io/docs/en/ignore.html

A JavaScript commentï¼ˆæ³¨é‡Šï¼‰ of ` prettier-ignore` will exclude the next node in the abstract syntax tree from formatting.

#### package.json

```json
{
	"script":{
		"lint": "eslint src --fix --ext .js,.ts,.jsx,.tsx"
	}
}
```



### .vscode/settings.json

ä¸‹è½½ vscodeçš„ESlintã€prettier æ’ä»¶

æ·»åŠ  eslintã€prettier è§„åˆ™

 vscodeçš„ESlint æ’ä»¶ä¼šä¼˜å…ˆæ‰§è¡Œ`.eslintrc.js`æ–‡ä»¶çš„é…ç½®ã€‚prettier åŒç†ã€‚

### editorconfig

vscodeä¸‹è½½**EditorConfig for VS Code**æ’ä»¶

é€šé…ç¬¦

```
*                åŒ¹é…é™¤/ä¹‹å¤–çš„ä»»æ„å­—ç¬¦ä¸²
**               åŒ¹é…ä»»æ„å­—ç¬¦ä¸²
?                åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦
[name]           åŒ¹é…nameä¸­çš„ä»»æ„ä¸€ä¸ªå•ä¸€å­—ç¬¦
[!name]          åŒ¹é…ä¸å­˜åœ¨nameä¸­çš„ä»»æ„ä¸€ä¸ªå•ä¸€å­—ç¬¦
{s1,s2,s3}       åŒ¹é…ç»™å®šçš„å­—ç¬¦ä¸²ä¸­çš„ä»»æ„ä¸€ä¸ª(ç”¨é€—å·åˆ†éš”) 
{num1..num2}   ã€€åŒ¹é…num1åˆ°num2ä¹‹é—´çš„ä»»æ„ä¸€ä¸ªæ•´æ•°, è¿™é‡Œçš„num1å’Œnum2å¯ä»¥ä¸ºæ­£æ•´æ•°ä¹Ÿå¯ä»¥ä¸ºè´Ÿæ•´æ•°
```

é…ç½®é€‰é¡¹

```
root = true                         # æ ¹ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œç¼–è¾‘å™¨ä¼šç”±å½“å‰ç›®å½•å‘ä¸ŠæŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ° `roor = true` çš„æ–‡ä»¶ï¼Œåˆ™ä¸å†æŸ¥æ‰¾

[*]                                 # åŒ¹é…æ‰€æœ‰çš„æ–‡ä»¶
indent_style = space                # ç©ºæ ¼ç¼©è¿›
indent_size = 4                     # ç¼©è¿›ç©ºæ ¼ä¸º4ä¸ª
end_of_line = lf                    # æ–‡ä»¶æ¢è¡Œç¬¦æ˜¯ linux çš„ `\n`
charset = utf-8                     # æ–‡ä»¶ç¼–ç æ˜¯ utf-8
trim_trailing_whitespace = true     # ä¸ä¿ç•™è¡Œæœ«çš„ç©ºæ ¼
insert_final_newline = true         # æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸€ä¸ªç©ºè¡Œ
curly_bracket_next_line = false     # å¤§æ‹¬å·ä¸å¦èµ·ä¸€è¡Œ
spaces_around_operators = true      # è¿ç®—ç¬¦ä¸¤ééƒ½æœ‰ç©ºæ ¼
indent_brace_style = 1tbs           # æ¡ä»¶è¯­å¥æ ¼å¼æ˜¯ 1tbs
spaces_around_brackets              # è¡¨ç¤ºæ‹¬å·å’Œæ‹¬å·ä¹‹é—´åº”æœ‰ç©ºæ ¼ï¼šæ— ç©ºæ ¼ï¼Œä»…åœ¨æ‹¬å·å†…ï¼Œä»…åœ¨æ‹¬å·å¤–æˆ–åœ¨æ‹¬å·çš„ä¸¤ä¾§ ï¼ˆnoneï¼Œinsideï¼Œoutsideï¼Œbothï¼‰
max_line_length                     # åœ¨æŒ‡å®šçš„å­—ç¬¦æ•°åå¼ºåˆ¶æ¢è¡Œã€‚offå…³é—­æ­¤åŠŸèƒ½
[*.js]                              # å¯¹æ‰€æœ‰çš„ js æ–‡ä»¶ç”Ÿæ•ˆ
quote_type = single                 # å­—ç¬¦ä¸²ä½¿ç”¨å•å¼•å·

[*.{html,less,css,json}]            # å¯¹æ‰€æœ‰ html, less, css, json æ–‡ä»¶ç”Ÿæ•ˆ
quote_type = double                 # å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·

[package.json]                      # å¯¹ package.json ç”Ÿæ•ˆ
indent_size = 2                     # ä½¿ç”¨2ä¸ªç©ºæ ¼ç¼©è¿›
```

å¸¸ç”¨é…ç½®

```
# http://editorconfig.org
# root: è¡¨æ˜æ˜¯æœ€é¡¶å±‚çš„é…ç½®æ–‡ä»¶ï¼Œå‘ç°è®¾ä¸ºtrueæ—¶ï¼Œæ‰ä¼šåœæ­¢æŸ¥æ‰¾.editorconfigæ–‡ä»¶ã€‚
root = true

[*]
# æ–‡ä»¶ç¼–ç 
charset = utf-8
# ä½¿ç”¨å•å¼•å·
quote_type = single
# æ¢è¡Œç¬¦æ ¼å¼
end_of_line = lf
# ç¼©è¿›æ•°é‡
indent_size = 2
# ç¼©è¿›ç±»å‹
indent_style = tab
# è¡Œæœ€å¤§é•¿åº¦ï¼Œè¦å’Œ.prettierrc.jsä¿æŒä¸€è‡´
max_line_length = 120
# åˆ é™¤æœ«å°¾ç©ºæ ¼
trim_trailing_whitespace = true
# ç»“å°¾æ’å…¥æ–°è¡Œ
insert_final_newline = true

[*.md]
trim_trailing_whitespace = false

[*.{html,css,less,scss,json}]       # å¯¹æ‰€æœ‰ html,css,less,scss,json æ–‡ä»¶ç”Ÿæ•ˆ
quote_type = double                 # å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·

# Makefileæ–‡ä»¶ä¸­è¦ç”¨tabç¼©è¿›ï¼Œè¿™ä¸ªç¡®å®æ˜¯å†å²é—ç•™é—®é¢˜ï¼Œç”¨ç©ºæ ¼ç¼©è¿›ä¼šå‡ºé”™ã€‚
[Makefile]
indent_style = tab
```

### stylelint

CSSè¯­æ³•è§„åˆ™å’Œé£æ ¼æ£€æµ‹å·¥å…·

### ignoreæ–‡ä»¶

æ”¯æŒ glob æ¨¡å¼

#### åŒç±»å‹æ–‡ä»¶æœ‰é¡ºåºä¹‹åˆ†

ä¾‹å¦‚ .gitignore

```
*.zip
!xxx.zip
```

**xxx.zip**ä¸ä¼šè¢«å¿½ç•¥

```
!xxx.zip
*.zip
```

**xxx.zip**ä¼šè¢«å¿½ç•¥

### git workflow

https://www.yuque.com/arvinxx-fe/workflow

https://juejin.cn/post/6934292467160514567

```
husky æˆ– yorkie å¯ä»¥è®©æˆ‘ä»¬å‘é¡¹ç›®ä¸­æ–¹ä¾¿æ·»åŠ git hooksã€‚
lint-staged æ˜¯ä¸€ä¸ªåœ¨gitæš‚å­˜æ–‡ä»¶ä¸Šè¿è¡Œlintersçš„å·¥å…·ï¼Œæ”¯æŒglobæ¨¡å¼ï¼Œåªé’ˆå¯¹ add çš„æ–‡ä»¶ï¼Œä¸æ˜¯æ‰€æœ‰æ–‡ä»¶ã€‚
Lint è¿™ä¸ªå•è¯çš„æœ¬æ„å°±æ˜¯è¡£æœä¸Šçš„æ£‰çƒï¼Œé€šè¿‡ Linting è¿™ä¸ªå•è¯çš„æ„æ€å°±æ˜¯å»é™¤ä»£ç ä¸­å¯èƒ½å­˜åœ¨é—®é¢˜çš„æ„æ€ã€‚
```

#### Git Hooks

[å®Œæ•´git hooks](https://git-scm.com/docs/githooks)

æ•´ä½“çš„hookséå¸¸å¤šï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨çš„æ¯”è¾ƒå¤šçš„å…¶å®åªæœ‰ä¸¤ä¸ª

`commit-msg`

- ç”± `git commit` å’Œ `git merge` è°ƒç”¨
- å¯ä»¥ä½¿ç”¨ `git commit --no-verify` ç»•è¿‡

`pre-commit`

- ç”± `git commit` è°ƒç”¨
- å¯ä»¥ä½¿ç”¨ `git commit --no-verify` ç»•è¿‡
- åœ¨è·å–å»ºè®®çš„æäº¤æ—¥å¿—æ¶ˆæ¯å’Œè¿›è¡Œæäº¤ä¹‹å‰è¢«è°ƒç”¨

`hook` è„šæœ¬ç½®äºç›®å½• `~/.git/hooks` ä¸­ï¼Œä»¥å¯æ‰§è¡Œæ–‡ä»¶çš„å½¢å¼å­˜åœ¨ã€‚

```bash
$ ls -lah .git/hooks
applypatch-msg.sample     pre-merge-commit.sample
commit-msg.sample         pre-push.sample
fsmonitor-watchman.sample pre-rebase.sample
post-update.sample        pre-receive.sample
pre-applypatch.sample     prepare-commit-msg.sample
pre-commit.sample         update.sample
```

å¦å¤– git hooks å¯ä½¿ç”¨ `core.hooksPath` è‡ªå®šä¹‰è„šæœ¬ä½ç½®ã€‚

```bash
# å¯é€šè¿‡å‘½ä»¤è¡Œé…ç½® core.hooksPath
$ git config 'core.hooksPath' .husky

# ä¹Ÿå¯é€šè¿‡å†™å…¥æ–‡ä»¶é…ç½® core.hooksPath
$ cat .git/config
[core]
  ignorecase = true
  precomposeunicode = true
  hooksPath = .husky
```

åœ¨å‰ç«¯å·¥ç¨‹åŒ–ä¸­ï¼Œ`husky` å³é€šè¿‡è‡ªå®šä¹‰ `core.hooksPath` å¹¶å°† `npm scripts` å†™å…¥å…¶ä¸­çš„æ–¹å¼æ¥å®ç°æ­¤åŠŸèƒ½ã€‚

#### å®‰è£…é…ç½®husky

1. å®‰è£…ä¾èµ– `npm install husky --save-dev`

2. ```
   npm set-script prepare "husky install"
   npm run prepare
   ```
   
   ```json
   // package.json ç”Ÿæˆ "prepare":"husky install"
   {
       "scripts":{
           "prepare":"husky install"
       }
   }
   ```
   
   `husky install`è¿è¡Œæ—¶éœ€è¦åœ¨åŒä¸€ç›®å½•ä¸‹å­˜åœ¨ `.git` ï¼Œå³æœ‰ä¸€ä¸ªgitä»“åº“ï¼Œè¿è¡ŒæˆåŠŸåæ ¹ç›®å½•ä¼šæ–°å»ºä¸€ä¸ª .husky ç›®å½•
   
   æ³¨æ„ï¼šset-script éœ€è¦ npm > 7.0 ç‰ˆæœ¬ å¯ä»¥ä½¿ç”¨ `npm install -g npm` å‡ç‰ˆæœ¬ã€‚

3. ```sh
   npx husky add .husky/pre-commit "npm test"
   ```

**å¸è½½uninstall**

```shell
npm uninstall husky && git config --unset core.hooksPath
```

#### pre-commit + lint-stagedè‡ªåŠ¨ä¿®å¤æ ¼å¼

`lint-staged` å¯ä»¥è®©ä½ å½“å‰çš„ä»£ç æ£€æŸ¥**åªæ£€æŸ¥æœ¬æ¬¡ä¿®æ”¹æ›´æ–°çš„ä»£ç ï¼Œå¹¶åœ¨å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œè‡ªåŠ¨ä¿®å¤å¹¶æ¨é€**ã€‚

> å¾ˆå¤šäººä¸ç”¨ lint-stagedï¼Œç›´æ¥åœ¨ pre-commit é’©å­é‡Œæ‰§è¡Œ npm run lintï¼Œè¿™æ ·æœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœé¡¹ç›®å¤§äº†ï¼Œä½ åªä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†å®ƒä»ç„¶ä¼šæ ¡éªŒsrcä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå°±ä¼šå¯¼è‡´æä¸ªä»£ç æ…¢çš„è¦æ­»ç­‰åŠå¤©ã€‚è€Œ lint-staged å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒåªä¼šæ ¡éªŒä½ ä¿®æ”¹çš„é‚£éƒ¨åˆ†æ–‡ä»¶ã€‚

æ¯æ¬¡å®ƒåœ¨ä½ æœ¬åœ° commit ä¹‹å‰ï¼Œæ ¡éªŒä½ æ‰€æçš„å†…å®¹æ˜¯å¦ç¬¦åˆä½ æœ¬åœ°é…ç½®çš„ eslint è§„åˆ™

1. ç¬¦åˆè§„åˆ™ï¼Œæäº¤æˆåŠŸ
2. ä¸ç¬¦åˆè§„åˆ™ï¼Œä»–ä¼šè‡ªåŠ¨æ‰§è¡Œ `eslint --fix` å°è¯•å¸®ä½ è‡ªåŠ¨ä¿®å¤ 2.1 ä¿®å¤æˆåŠŸï¼Œåˆ™ä¼šè‡ªåŠ¨å¸®ä½ æŠŠä¿®å¤å¥½çš„ä»£ç æäº¤ï¼› 2.2 ä¿®å¤å¤±è´¥ï¼Œæç¤ºä½ é”™è¯¯ï¼Œè®©ä½ ä¿®å¤å¥½æ‰å¯ä»¥æäº¤ä»£ç ï¼›

```sh
npm install lint-staged --save-dev
npx husky add .husky/pre-commit "npx lint-staged"
```

[ESlintå‘½ä»¤è¡Œ](https://eslint.cn/docs/user-guide/command-line-interface)

```
--ext æŒ‡å®šJavaScriptæ–‡ä»¶æ‰©å±•å-é»˜è®¤å€¼ï¼š.js
--fix è‡ªåŠ¨ä¿®å¤é—®é¢˜
```

**package.json**

```json
"scripts":{
    "lint": "eslint src --fix --ext .js,.jsx,.ts,.tsx",
},
"lint-staged": {
  "src/**":[
    "npm run lint"
  ]
}
```

æˆ–

```json
"scripts":{
    "lint": "lint-staged",
}
"lint-staged": {
   "**/*.js": "eslint --ext .js",  
   "**/*.vue": "eslint --ext .vue",  // å¯èƒ½éœ€è¦å®‰è£…eslint-plugin-vue
   "src/**/*.{js,vue}": [
     "prettier --write",
     "eslint  --fix",
     // "git add"  // ä»v10.0.0å¼€å§‹ï¼Œå¯¹æœ€åˆæš‚å­˜æ–‡ä»¶çš„ä»»ä½•æ–°ä¿®æ”¹éƒ½å°†è‡ªåŠ¨æ·»åŠ åˆ°æäº¤ä¸­ã€‚å¦‚æœæ‚¨çš„ä»»åŠ¡ä»¥å‰åŒ…å«git addæ­¥éª¤ï¼Œè¯·åˆ é™¤æ­¤æ­¥éª¤ã€‚è‡ªåŠ¨è¡Œä¸ºå¯ç¡®ä¿ç«äº‰æ¡ä»¶è¾ƒå°‘ï¼Œå› ä¸ºå°è¯•åŒæ—¶è¿è¡Œå¤šä¸ªgitæ“ä½œé€šå¸¸ä¼šå¯¼è‡´é”™è¯¯ã€‚
   ]
},
```

æˆ–ä½¿ç”¨**yorkie**ï¼Œè€Œä¸ä½¿ç”¨husky

```sh
npm install yorkie --save-dev
```

```json
"scripts":{
    "lint": "eslint src --fix --ext .js,.jsx,.ts,.tsx",
},
"gitHooks": {
    "pre-commit": "lint-staged"
},
"lint-staged": {
  "src/**":[
    "npm run lint"
  ]
}
```

#### Augular Commit è§„èŒƒ

```html
<type>(<scope>): <subject> #headeréƒ¨åˆ†
// ç©ºä¸€è¡Œ
<body>
// ç©ºä¸€è¡Œ
<footer> 
```

**Header**æ˜¯å¿…éœ€ï¼Œ**Body** å’Œ **Footer** å¯ä»¥çœç•¥

##### Header

Headeréƒ¨åˆ†åªæœ‰ä¸€è¡Œï¼ŒåŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼štypeï¼ˆå¿…éœ€ï¼‰ã€scopeï¼ˆå¯é€‰ï¼‰å’Œsubjectï¼ˆå¿…éœ€ï¼‰ã€‚

###### type

> ç”¨äºè¯´æ˜æœ¬æ¬¡commitçš„ç±»å‹

å…è®¸ä½¿ç”¨ä¸‹é¢ä¸ªæ ‡è¯†

- featï¼šæ–°åŠŸèƒ½ï¼ˆfeatureï¼‰
- fixï¼šä¿®è¡¥bug
- docsï¼šæ–‡æ¡£ï¼ˆdocumentationï¼‰
- styleï¼š æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰
- refactorï¼šé‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰
- perf: æ€§èƒ½æå‡ï¼ˆæé«˜æ€§èƒ½çš„ä»£ç æ”¹åŠ¨ï¼‰
- testï¼šæµ‹è¯•
- buildï¼šå½±å“æ„å»ºç³»ç»Ÿæˆ–å¤–éƒ¨ä¾èµ–é¡¹çš„æ›´æ”¹ï¼ˆgulpï¼Œnpmç­‰ï¼‰ï¼ŒChanges to the build process or auxiliary tools and libraries
- ciï¼šæ›´æ”¹CIé…ç½®æ–‡ä»¶å’Œè„šæœ¬ï¼ŒCI configuration related e.g. changes to k8sï¼Œdocker configuration files.
- choreï¼šæ›´æ”¹æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å’Œåº“ï¼Œä¾‹å¦‚æ–‡æ¡£ç”Ÿæˆ
- revertï¼šæ’¤é€€ä¹‹å‰çš„commitã€‚ Reverts a previous commit

| Type         | Description                                                                                            |
| ------------ | ------------------------------------------------------------------------------------------------------ |
| **feat**     | A new feature                                                                                          |
| **fix**      | A bug fix                                                                                              |
| **docs**     | Documentation only changes                                                                             |
| **style**:   | Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc) |
| **refactor** | A code change that neither fixes a bug nor adds a feature                                              |
| **perf**     | A code change that improves performance                                                                |
| **test**     | Adding missing or correcting existing tests                                                            |
| **chore**    | Changes to the build process or auxiliary tools and libraries such as documentation generation         |

**å¦‚æœtypeä¸ºfeatã€fixã€perfã€revertï¼Œåˆ™è¯¥ commit å°†è‚¯å®šå‡ºç°åœ¨ Change log ä¹‹ä¸­ã€‚å…¶ä»–æƒ…å†µï¼ˆdocsã€choreã€styleã€testï¼‰ç”±ä½ å†³å®šï¼Œè¦ä¸è¦æ”¾å…¥ Change logã€‚**

**Revert**

> è¿˜æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå¦‚æœå½“å‰ commit ç”¨äºæ’¤é”€ä»¥å‰çš„ commitï¼Œåˆ™å¿…é¡»ä»¥revert:å¼€å¤´ï¼Œåé¢è·Ÿç€è¢«æ’¤é”€ Commit çš„ Headerã€‚
> 
> Bodyéƒ¨åˆ†çš„æ ¼å¼æ˜¯å›ºå®šçš„ï¼Œå¿…é¡»å†™æˆThis reverts commit <hash> .  å…¶ä¸­çš„hashæ˜¯è¢«æ’¤é”€ commit çš„ SHA æ ‡è¯†ç¬¦ã€‚

```
revert: feat(pencil): add 'graphiteWidth' option

This reverts commit 667ecc1654a317a13331b17617d973392f415f02.
```

å…¶ä¸­çš„hashæ˜¯è¢«æ’¤é”€ commit çš„ SHA æ ‡è¯†ç¬¦ã€‚

###### scope

> ç”¨äºè¯´æ˜æœ¬æ¬¡commitå½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚é¦–é¡µã€è¯¦æƒ…é¡µç­‰ã€‚å½“æ›´æ”¹å½±å“å¤šä¸ªèŒƒå›´æ—¶ï¼Œå¯ä»¥ä½¿ç”¨*ã€‚

###### subject

> ç”¨äºè¯´æ˜æœ¬æ¬¡commitçš„ç®€çŸ­æè¿°

- ä½¿ç”¨ç¥ˆä½¿å¥ï¼Œç°åœ¨æ—¶æ€ï¼š"change" not "changed" nor "changes"
- é¦–å­—æ¯å°å†™
- å¥æœ«ä¸è¦å¥å·

###### ticket

`ticket` æ˜¯ commit ç›¸å…³è”çš„ issue ç¼–å·ã€‚æ¯ä¸€æ¬¡ commit éƒ½å¯ä»¥é€‰æ‹©æ€§çš„ä¸æŸä¸ª issue å…³è”ã€‚

æ¯”å¦‚åœ¨ message ä¸­æ·»åŠ  #nï¼Œå°±å¯ä»¥ä¸ç¬¬ n ä¸ª issue è¿›è¡Œå…³è”ã€‚è¿™ä¸ªæäº¤ä¼šä½œä¸ºä¸€ä¸ª comment ï¼Œå‡ºç°åœ¨ç¼–å·ä¸º1çš„ issue è®°å½•ä¸­ã€‚

```
:gitmoji: type(scope): subject(#1)
```

å¦‚æœæ·»åŠ ï¼š

- close #n

- closes #n

- closed #n

- fix #n

- fixes #n

- fixed #n

- resolve #n

- resolves #n

- resolved #n

æ¯”å¦‚ä»¥ä¸‹ Commit å¯ä»¥è‡ªåŠ¨å…³é—­ç¬¬ 4 ä¸ª issue ã€‚

```
:bug: fix: Fix bug(#4)
```

##### Body

> ç”¨äºæœ¬æ¬¡commitçš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œ
> 
> ä½¿ç”¨ç¥ˆä½¿å¥ï¼Œç°åœ¨æ—¶æ€ï¼š"change" not "changed" nor "changes"

```bash
<type>(<scope>): <subject> 

- first changes...  #bodyéƒ¨åˆ†
- second changes... #bodyéƒ¨åˆ†
```

##### Footer

åªç”¨äºä¸‹é¢ä¸¤ç§æƒ…å†µ

###### æ˜¯å¦äº§ç”Ÿäº†ç ´åæ€§ä¿®æ”¹

å¦‚æœå½“å‰ä»£ç ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬å‡ºç°é‡å¤§å˜åŠ¨æˆ–ä¸å…¼å®¹ï¼Œå¦‚ç‰ˆæœ¬å‡çº§ã€æ¥å£å‚æ•°å‡å°‘ã€æ¥å£åˆ é™¤ã€è¿ç§»ç­‰å°±æ˜¯ç ´åæ€§ä¿®æ”¹ã€‚åˆ™ Footer éƒ¨åˆ†ä»¥BREAKING CHANGEå¼€å¤´ï¼Œåé¢ç©ºä¸€æ ¼æˆ–ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œç„¶åæè¿°å˜åŠ¨ã€ä»¥åŠå˜åŠ¨ç†ç”±å’Œè¿ç§»æ–¹æ³•ã€‚

```
BREAKING CHANGE: å˜åŠ¨çš„æè¿°\ç†ç”±\è¿ç§»æ–¹æ³•
```

###### å…³é—­Issue

å¦‚æœå½“å‰ commit é’ˆå¯¹æŸä¸ª issueï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Footer éƒ¨åˆ†å…³é—­è¿™ä¸ª issueï¼Œä¹Ÿå¯ä»¥å…³é—­å¤šä¸ª issueã€‚å¡«å†™æ ¼å¼å¦‚ä¸‹ï¼š

```
Close #ISSUE_ID
Closes #ISSUE_ID, #ISSUE_ID
```

#### commitizen

ä½¿ç”¨Commitizenæäº¤æ—¶ï¼Œç³»ç»Ÿä¼šæç¤ºæ‚¨åœ¨æäº¤æ—¶å¡«å†™æ‰€æœ‰å¿…éœ€çš„æäº¤å­—æ®µã€‚

 **adapter(é€‚é…å™¨)** : æ›´æ¢ commitizen å‘½ä»¤è¡Œå·¥å…·çš„**äº¤äº’æ–¹å¼**æ’ä»¶ã€‚

```shell
npm install -D commitizen cz-customizable
```

å®‰è£…æˆåŠŸä»¥åï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä¸å†ä½¿ç”¨ `git commit` çš„æ–¹å¼æäº¤ä½ çš„ä»£ç ã€‚

åœ¨ä½ æ‰§è¡Œå®Œ `git add` åï¼Œæ‰§è¡Œ `npx cz` æˆ– `npm run commit` æ›¿ä»£ `git commit`ï¼Œcommitizen å°±å¯ä»¥**ä¸€æ­¥æ­¥**å¸®åŠ©ä½ å®Œæˆæäº¤äº†ã€‚

```json
// package.json
{
    "scripts":{
        "commit":"cz"
    }
}
```

##### cz-customizable é€‚é…å™¨

```json
// package.json
{
  "config": {
    "commitizen": {
      "path": "./node_modules/cz-customizable"
    },
  }
}
```

æ ¹ç›®å½•æ–°å»º `.cz-config.js`

```js
module.exports = {
  types: [
    { value: 'feat', name: 'âœ¨ feat:       A new feature' },
    { value: 'fix', name: 'ğŸ”§ fix:        A bug fix' },
    { value: 'docs', name: 'ğŸ“ docs:       Documentation only changes' },
    { value: 'style', name: 'ğŸ¨ style:      Changes that do not affect the meaning of the code' },
    { value: 'refactor', name: 'â™»ï¸  refactor:   A code change that neither fixes a bug nor adds a feature' },
    { value: 'perf', name: 'ğŸš€ perf:       A code change that improves performance' },
    { value: 'test', name: 'ğŸ§ª test:       Adding missing or correcting existing tests' },
    { value: 'ci', name: 'ğŸ‘· ci:         CI configuration related e.g. changes to k8sï¼Œdocker configuration files' },
    { value: 'build', name: 'ğŸ“¦â€ build:      Changes to the build process or auxiliary tools' },
    { value: 'chore', name: 'ğŸ» chore:      chroe' },
    { value: 'revert', name: 'ğŸ’Š revert:     Reverts a previous commit' }
  ],
  scopes: [
    { name: 'docs' },
    { name: 'ci' },
    { name: 'style' },
  ],

  // allowTicketNumber: false,
  // isTicketNumberRequired: false,
  // ticketNumberPrefix: 'TICKET-',
  // ticketNumberRegExp: '\\d{1,5}',

  // it needs to match the value for field type. Eg.: 'fix'
  // å½“ type ä¸º fix æ—¶ï¼Œé‡å†™ scopes çš„å€¼
  /*  scopeOverrides: {
    fix: [
      {name: 'merge'},
      {name: 'style'},
      {name: 'e2eTest'},
      {name: 'unitTest'}
    ]
  },  */
  // override the messages, defaults are as follows
  messages: {
    type: "Select the type of change that you're committing:",
    scope: 'Denote the SCOPE of this change (optional):',
    // used if allowCustomScopes is true
    customScope: 'Denote the SCOPE of this change:',
    subject: 'Write a SHORT, IMPERATIVE tense description of the change:\n',
    body: 'Provide a LONGER description of the change (optional). Use "|" to break new line:\n',
    breaking: 'List any BREAKING CHANGES (optional):\n',
    footer: 'List any ISSUES CLOSED by this change (optional). E.g.: #31, #34:\n',
    confirmCommit: 'Are you sure you want to proceed with the commit above?',
  },
  allowCustomScopes: true,
  allowBreakingChanges: ['feat', 'fix'],
  subjectLimit: 100,
  // skip any questions you want
  // skipQuestions: ['body'],
  // limit subject length
  // breaklineChar: '|', // It is supported for fields body and footer.
  // footerPrefix : 'ISSUES CLOSED:'
  // askForBreakingChangeFirst : true, // default is false
}
```



##### cz-emoji é€‚é…å™¨

```json
// package.json
{
    "config": {
    "commitizen": {
      "path": "./node_modules/cz-emoji"
    },
    "cz-emoji": {
      "types": [
        {
          "emoji": "âœ¨",
          "code": "âœ¨ feat",
          "description": "A new feature",
          "name": "feature"
        },
        {
          "emoji": "ğŸ”§",
          "code": "ğŸ”§ fix",
          "description": " A bug fix",
          "name": "fix"
        },
        {
          "emoji": "ğŸ“",
          "code": "ğŸ“ docs",
          "description": "Documentation only changes",
          "name": "docs"
        },
        {
          "emoji": "ğŸ¨",
          "code": "ğŸ¨ style",
          "description": "Changes that do not affect the meaning of the code",
          "name": "style"
        },
        {
          "emoji": "â™»ï¸",
          "code": "â™»ï¸ refactor",
          "description": " A code change that neither fixes a bug nor adds a feature",
          "name": "refactor"
        },
        {
          "emoji": "ğŸš€",
          "code": "ğŸš€ perf",
          "description": "A code change that improves performance",
          "name": "perf"
        },
        {
          "emoji": "ğŸ§ª",
          "code": "ğŸ§ª test",
          "description": "**Adding missing or correcting existing tests",
          "name": "test"
        },
        {
          "emoji": "ğŸ‘·",
          "code": "ğŸ‘· ci",
          "description": "CI configuration related e.g. changes to k8sï¼Œdocker configuration files",
          "name": "ci"
        },
        {
          "emoji": "ğŸ“¦â€",
          "code": "ğŸ“¦â€ build",
          "description": "Changes to the build process or auxiliary tools",
          "name": "build"
        },
        {
          "emoji": "ğŸ»",
          "code": "ğŸ» chore",
          "description": "chore",
          "name": "chore"
        },
        {
          "emoji": "ğŸ’Š",
          "code": "ğŸ’Š revert",
          "description": "Reverts a previous commit",
          "name": "revert"
        }
      ],
      "scopes": [
        "docs",
        "ci",
        "style"
      ],
      "subjectMaxLength": 50
    }
  }
}
```

**æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ vscode æ’ä»¶  `git-commit-plugin` å®ç°ä¸Šè¿°çš„åŠŸèƒ½**ã€‚

#### Commitlint

Lint commit messages. 

##### @commitlint/config-conventional

```shell
npm i -D @commitlint/cli @commitlint/config-conventional
```

```js
module.exports = {
  extends: ['@commitlint/config-conventional'],
  /*
   * Any rules defined here will override rules from extends-config
   */
  // 0 disables the rule. For 1 it will be considered a warning for 2 an error.
  // always|never: never inverts(å–å) the rule.
  rules: { // è¦å’Œ .cz-config.js çš„ type ä¿æŒå®Œå…¨ä¸€è‡´
    "type-enum": [2, 'always', ['feat', 'fix', 'docs', 'style', 'refactor', 'perf', 'test', 'ci', 'build', 'chore', 'revert']]
  },
}
```

##### emoji

```shell
npm i -D @commitlint/cli commitlint-config-git-commit-emoji
```

**commitlint.config.js**

**æ•°ç»„é‡Œçš„typeç±»å‹ï¼ˆåŒ…æ‹¬emojiï¼‰è¦å’Œ .cz-config.js çš„ value ä¿æŒä¸€è‡´**

```js
module.exports = {
  extends: ['git-commit-emoji'], // commitlint-config-git-commit-emoji å¯çœç•¥å‰ç¼€ commitlint-config-
  /*
   * Any rules defined here will override rules from extends-config
   */
  rules: { // è¦å’Œ .cz-config.js çš„ type ä¿æŒå®Œå…¨ä¸€è‡´
    "type-enum": [2, 'always', ['âœ¨ feat', 'ğŸ”§ fix', 'ğŸ“ docs', 'ğŸ¨ style', 'â™»ï¸  refactor', 'ğŸš€ perf', 'ğŸ§ª test', 'ğŸ‘· ci', 'ğŸ“¦â€ build', 'ğŸ» chore', 'âªï¸ revert']]
  },
}
```

æ·»åŠ  commitlint çš„ hook åˆ° husky ä¸­ï¼Œ`commit-msg` æ—¶è¿›è¡Œæ ¡éªŒ

```shell
# Add hook
npx husky add .husky/commit-msg 'npx --no -- commitlint --edit "$1"'
# Sometimes above command doesn't work in some command interpreters
# You can try other commands below to write npx --no -- commitlint --edit $1
# in the commit-msg file.
npx husky add .husky/commit-msg \"npx --no -- commitlint --edit '$1'\"
# or
npx husky add .husky/commit-msg "npx --no -- commitlint --edit $1"

# or
yarn husky add .husky/commit-msg 'yarn commitlint --edit $1'
```

- **--no**ï¼šå¦‚æœæœ¬åœ°é¡¹ç›®ä¾èµ–é¡¹ä¸­ä¸å­˜åœ¨ä»»ä½•è¯·æ±‚çš„åŒ…ï¼Œåˆ™å°†å®ƒä»¬å®‰è£…åˆ°npmç¼“å­˜ä¸­çš„ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œè¯¥æ–‡ä»¶å¤¹å°†æ·»åŠ åˆ°æ‰§è¡Œè¿‡ç¨‹ä¸­çš„PATHç¯å¢ƒå˜é‡ä¸­ã€‚
- **commitlint --edit**ï¼šread last commit message from the specified file or                       fallbacks to ./.git/COMMIT_EDITMSG.
- **$1**ï¼šä¼ é€’ç»™è¯¥shellè„šæœ¬çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚

#### CHANGELOG

##### semantic-release

**semantic-release**è‡ªåŠ¨åŒ–äº†æ•´ä¸ªè½¯ä»¶åŒ…å‘å¸ƒå·¥ä½œæµï¼ŒåŒ…æ‹¬ï¼šç¡®å®šä¸‹ä¸€ä¸ªç‰ˆæœ¬å·ã€ç”Ÿæˆreleaseè¯´æ˜å’Œå‘å¸ƒè½¯ä»¶åŒ…ã€‚ï¼ˆæ‰“tagã€releaseã€ä¿®æ”¹package.json versionã€ç”ŸæˆCHANGLOG.mdï¼Œnpm publishï¼‰

```shell
npm i -D semantic-release @semantic-release/changelog @semantic-release/git conventional-changelog-conventionalcommits
```

> semantic-release çš„ä¾èµ–åŒ…ï¼Œæ— é¡»å†ä¸‹è½½ï¼š
> 
> ```
> "@semantic-release/commit-analyzer"
> "@semantic-release/release-notes-generator"
> "@semantic-release/npm"
> "@semantic-release/github"
> ```

æ–‡ä»¶å¤¹æ ¹ç›®å½•åˆ›å»º **.releaserc.js**

```javascript
// semantic-release é…ç½®
module.exports = {
  branches: [ // æŒ‡å®šåœ¨å“ªä¸ªåˆ†æ”¯ä¸‹è¦æ‰§è¡Œå‘å¸ƒæ“ä½œ
    'master',
    {
      name: 'beta', prerelease: true // beta åˆ†æ”¯ä¸º é¢„å‘å¸ƒ åˆ†æ”¯ 2.0.0-beta.1, 2.0.0-beta.2, etc...
    }
  ],
  plugins: [ // æ’ä»¶æœ‰é¡ºåºè¦æ±‚
    [
      '@semantic-release/commit-analyzer', // semantic-release plugin to analyze commits with conventional-changelog
      {
        preset: "conventionalcommits", // éœ€å®‰è£… conventional-changelog-conventionalcommits
        // æ²¡åˆ—åœ¨è¿™é‡Œæˆ–è€…ä¸åœ¨ default release rules(https://github.com/semantic-release/commit-analyzer/blob/master/lib/default-release-rules.js) é‡Œçš„è§„åˆ™ï¼Œä¸ä¼šè¿›è¡Œ release
        "releaseRules": [
          { type: 'feat', release: 'minor' },
          { type: 'fix', release: 'patch' },
          { type: 'perf', release: 'patch' },
          { type: 'style', release: 'patch' },
          { type: 'revert', release: 'patch' },
          { breaking: true, release: 'major' }, // https://www.conventionalcommits.org/en a commit that has a footer BREAKING  CHANGE: 
        ],
        "parserOpts": {
          "noteKeywords": ["BREAKING CHANGE", "BREAKING CHANGES"] // the commits that contains BREAKING CHANGE, BREAKING CHANGES or BREAKING in their body will be considered breaking changes(by default the angular preset checks only for BREAKING CHANGE and BREAKING CHANGES)
        }
      }
    ],
    ['@semantic-release/release-notes-generator', // semantic-release plugin to generate changelog content(éæ–‡ä»¶) with conventional-changelog
      {
        preset: "conventionalcommits",
        presetConfig: { // Conventional Changelog Configuration Spec, https://github.com/conventional-changelog/conventional-changelog-config-spec
          "types": [
            { "type": "feat", "section": "âœ¨ Features | æ–°åŠŸèƒ½" },
            { "type": "fix", "section": "ğŸ› ï¸ Bug Fixes | Bug ä¿®å¤" },
            { "type": "docs", "section": "ğŸ“ Documentation | æ–‡æ¡£" },
            { "type": "style", "section": "ğŸ¨ Styles | é£æ ¼" },
            { "type": "refactor", "section": "â™»ï¸ Code Refactoring | ä»£ç é‡æ„" },
            { "type": "perf", "section": "ğŸš€ Performance Improvements | æ€§èƒ½ä¼˜åŒ–" },
            { "type": "test", "section": "ğŸ“¸ Tests | æµ‹è¯•" },
            { "type": "build", "section": "ğŸ“¦â€ Build System | æ‰“åŒ…æ„å»º" },
            { "type": "ci", "section": "ğŸ³ Continuous Integration | CI é…ç½®" },
            { "type": "chore", "section": "ğŸ® Chore | æ„å»º/å·¥ç¨‹ä¾èµ–/å·¥å…·" },
            { "type": "revert", "section": "ğŸ’Š Revert | å›é€€" }
          ]
        }
      }
    ],
    [
      '@semantic-release/changelog', // semantic-release plugin to create or update a changelog file
      {
        changelogFile: 'CHANGELOG.md'
      }
    ],
    // éœ€è¦NPM_TOKENï¼Œå‘½ä»¤è¡Œcross-envã€æˆ– .npmrc æ–‡ä»¶ æˆ–åœ¨ github actionsä¸­å®šä¹‰
    // æ ¹æ®commit typeï¼ŒUpdate the package.json version
    '@semantic-release/npm',  // semantic-release plugin to publish a npm package.
    // éœ€è¦GITHUB_TOKEN
    [
      '@semantic-release/github', // åˆ›å»º github-release
      {
        labels: false // The labels to add to the issue created when a release fails. Set to false to not add any label.
      }
    ],
    [
      '@semantic-release/git', // semantic-release plugin to commit release assets to the project's git repository.
      {
        assets: ['CHANGELOG.md', 'package.json'], // releaseæˆåŠŸåï¼Œè¿œç¨‹ä»“åº“çš„CHANGELOG.mdã€package.json ä¼šæ›´æ–°ï¼Œæœ¬åœ°ä»“åº“éœ€è¦ git pull æ‹‰å–
        message: "ğŸº chore(release): ${nextRelease.version} [skip ci]\n\n${nextRelease.notes}"
      }
    ]
  ]
}
```

**conventional-changelog-emoji-config** èƒ½å¤Ÿå°† `:emoji: type: â€¦ ` æˆ– `è¡¨æƒ… type: â€¦` æ ¼å¼è¿›è¡Œ **type** åˆ†ç±»ã€‚

ä½†ä¸æ”¯æŒ `@semantic-release/release-notes-generator`ä¸­çš„`presetConfig`ï¼Œå› ä¸º**conventional-changelog-emoji-config**çš„é…ç½®ä¸ç¬¦åˆ[conventional-changelog-config-spec è§„èŒƒ](https://github.com/conventional-changelog/conventional-changelog-config-spec)

æ ¹ç›®å½•æ–°å»º **.changelogrc.js**

```js
// conventional-changelog-emoji-config é…ç½®
module.exports = {
  displayTypes: ['build', 'ci', 'feat', 'fix', 'docs', 'style', 'refactor', 'perf', 'test', 'chore', 'revert',]
}
```



##### standard-version

ä½¿ç”¨ **semantic-release** å°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬å‘å¸ƒå’Œchanglogçš„éœ€æ±‚ã€‚

**standard-version** æ˜¯ä¸€æ¬¾éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆ semverï¼‰å’Œ commit message æ ‡å‡†è§„èŒƒ çš„ç‰ˆæœ¬å’Œ changlog è‡ªåŠ¨åŒ–å·¥å…·ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šåœ¨ master åˆ†æ”¯è¿›è¡Œå¦‚ä¸‹çš„ç‰ˆæœ¬å‘å¸ƒæ“ä½œï¼š

1. git pull origin master

2. æ ¹æ® pacakage.json ä¸­çš„ version æ›´æ–°ç‰ˆæœ¬å·ï¼Œæ›´æ–° changelog

3. git add -A, ç„¶å git commit

4. git tag æ‰“ç‰ˆæœ¬æ“ä½œ

5. push ç‰ˆæœ¬ tag å’Œ master åˆ†æ”¯åˆ°ä»“åº“

å…¶ä¸­2ï¼Œ3ï¼Œ4åˆ™æ˜¯ standard-version å·¥å…·ä¼šè‡ªåŠ¨å®Œæˆçš„å·¥ä½œï¼Œé…åˆæœ¬åœ°çš„ shell è„šæœ¬ï¼Œåˆ™å¯ä»¥è‡ªåŠ¨å®Œæˆä¸€ç³»åˆ—ç‰ˆæœ¬å‘å¸ƒçš„å·¥ä½œäº†ã€‚

```sh
npm i -D standard-version conventional-changelog-emoji-config
```

- `conventional-changelog-emoji-config` æˆ– `conventional-changelog-gitmoji-config`  â€”â€” emoji é£æ ¼çš„ conventional-changelog è§„åˆ™ï¼Œåé¢ä¼šè®²åˆ°

package.json

```json
{
  "scripts": {
     "release": "standard-version",
     "release-major": "standard-version --release-as major",
     "release-minor": "standard-version --release-as minor",
     "release-patch": "standard-version --release-as patch"
  }
}
```

**ç‰ˆæœ¬æ„æˆ**

https://semver.org/lang/zh-CN/

ç‰ˆæœ¬å· `major.minor.patch`

- `major`: å½“ä½ å‘äº†ä¸€ä¸ªå«æœ‰ Breaking Change çš„ API
- `minor`: å½“ä½ æ–°å¢äº†ä¸€ä¸ªå‘åå…¼å®¹çš„åŠŸèƒ½æ—¶
- `patch`: å½“ä½ ä¿®å¤äº†ä¸€ä¸ªå‘åå…¼å®¹çš„ Bug 

**å‘½ä»¤è¯´æ˜**

- `release`: æŒ‰ç…§`standard-version`é»˜è®¤è§„åˆ™å‡çº§ç‰ˆæœ¬å·
- `release-major`: å‡çº§majorç‰ˆæœ¬å·
- `release-minor`: å‡çº§minorç‰ˆæœ¬å·
- `release-patch`: å‡çº§patchç‰ˆæœ¬å·

standard-version **é»˜è®¤ç‰ˆæœ¬å‡çº§è§„åˆ™**

- feature ä¼šæ›´æ–° minor
- bug fix ä¼šæ›´æ–° patch
- BREAKING CHANGES ä¼šæ›´æ–° minor

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°±ä¼šæ ¹æ®ä½ çš„commitä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆ CHANGELOG.md æ–‡ä»¶ã€‚

```sh
npm run release
```

å½“ä½ çš„commit typeæ˜¯ featå’Œfixçš„æ—¶å€™æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œå®ƒä¼šè‡ªå¢ package.json ç‰ˆæœ¬å·ã€‚

æ ¹ç›®å½•æ–°å»º **versionrc.js**

```json
module.exports = {
  "types": [
    { "type": "feat", "section": "âœ¨ Features | æ–°åŠŸèƒ½" },
    { "type": "fix", "section": "ğŸ”§ Bug Fixes | Bug ä¿®å¤" },
    { "type": "docs", "section": "ğŸ“ Documentation | æ–‡æ¡£" },
    { "type": "style", "section": "ğŸ¨ Styles | é£æ ¼" },
    { "type": "refactor", "section": "â™»ï¸ Code Refactoring | ä»£ç é‡æ„" },
    { "type": "perf", "section": "ğŸš€ Performance Improvements | æ€§èƒ½ä¼˜åŒ–" },
    { "type": "test", "section": "ğŸ“¸ Tests | æµ‹è¯•" },
    { "type": "build", "section": "ğŸ“¦â€ Build System | æ‰“åŒ…æ„å»º" },
    { "type": "ci", "section": "ğŸ³ Continuous Integration | CI é…ç½®" },
    { "type": "chore", "section": "ğŸ® Chore | æ„å»º/å·¥ç¨‹ä¾èµ–/å·¥å…·" }, 
    { "type": "revert", "section": "ğŸ’Š Revert | å›é€€" }
  ]
}
```

###### [é…ç½®è¯´æ˜](https://github.com/conventional-changelog/conventional-changelog-config-spec/)

```js
"types": [
    {"type": "feat", "section": "Features"},
    {"type": "fix", "section": "Bug Fixes"},
    {"type": "chore", "hidden": true},
    {"type": "docs", "hidden": true},
    {"type": "style", "hidden": true},
    {"type": "refactor", "hidden": true},
    {"type": "perf", "hidden": true},
    {"type": "test", "hidden": true}
]
```

**types**

| name        | type      | required | default | description                                                                                                           |
| ----------- | --------- | -------- | ------- | --------------------------------------------------------------------------------------------------------------------- |
| **type**    | `string`  | âœ”ï¸       | `N/A`   | A string used to match `<type>`s used in the [Conventional Commits](https://www.conventionalcommits.org/) convention. |
| **section** | `string`  | âœ–ï¸       | `N/A`   | The section where the matched commit `type` will display in the CHANGELOG.                                            |
| **hidden**  | `boolean` | âœ–ï¸       | `N/A`   | Set to `true` to hide matched commit `type`s in the CHANGELOG.                                                        |

###### é¢„è®¾

standard-version é»˜è®¤çš„é¢„è®¾æ˜¯ angular ï¼Œåƒä¹‹å‰è‡ªå®šä¹‰è¡¨æƒ…é‚£ç§commmitï¼Œè§„èŒƒå’Œangularä¸ä¸€æ ·ï¼Œå®ƒè¯»ä¸åˆ°å¯¹åº”çš„typeç”Ÿæˆçš„æ›´æ”¹æ—¥å¿—æ˜¯æ²¡æ³•åˆ†ç±»çš„ã€‚æ ¹æ® :emoji: type: â€¦ æ ¼å¼ç”Ÿæˆ CHANGELOG çš„å·¥å…·ï¼š

[conventional-changelog-emoji-config](https://www.npmjs.com/package/conventional-changelog-emoji-config)

[conventional-changelog-gitmoji-config](https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fconventional-changelog-gitmoji-config)

```shell
npm i -D conventional-changelog-emoji-config
npx husky add .husky/pre-push "npm run release"
```

```json
{
  "scripts": {
    "release": "standard-version --preset emoji-config",
    "release-major": "standard-version --preset emoji-config --release-as major",
    "release-minor": "standard-version --preset emoji-config --release-as minor",
    "release-patch": "standard-version --preset emoji-config --release-as patch"
  }
}
```

> å¯ä»¥çœç•¥å‰ç¼€  conventional-changelog-

æ ¹ç›®å½•æ–°å»º **.changelogrc.js**

```js
module.exports = {
  // changlog å¯ä»¥æ˜¾ç¤ºçš„type
  displayTypes: ['build', 'ci', 'feat', 'fix', 'docs', 'style', 'refactor', 'perf', 'test', 'chore', 'revert',]
}
```

- **commitlint.config.js**ã€**.cz-config.js**  type ç±»å‹è¦ä¸€è‡´ï¼ˆåŒ…æ‹¬emojiï¼‰
- **.versionrc.js** ä¸ **.changelogrc.js**  type ç±»å‹è¦ä¸€è‡´
- å››ä¸ªæ–‡ä»¶çš„typeï¼ˆä¾‹å¦‚ build ï¼Œä½†ä¸åŒ…æ‹¬emojiï¼‰è¦ä¸€è‡´



### æ£€æµ‹ä¾èµ–å®‰å…¨

å¦‚ä½•ç¡®ä¿æ‰€æœ‰ `npm install` çš„ä¾èµ–éƒ½æ˜¯å®‰å…¨çš„ï¼Ÿ

å½“æœ‰ä¸€ä¸ªåº“å·å·åœ¨ä½ çš„ç¬”è®°æœ¬åå°æŒ–çŸ¿æ€ä¹ˆåŠï¼Ÿ

æ¯”å¦‚ï¼Œä¸ä¹…å‰ä¸€ä¸ªå‘¨ä¸‹è½½é‡è¶…è¿‡å…«ç™¾ä¸‡çš„åº“è¢«ä¾µå…¥ï¼Œå®ƒåœ¨ä½ çš„ç¬”è®°æœ¬è¿è¡Œæ—¶ä¼šå·å·æŒ–çŸ¿ã€‚

#### Audit

`Audit`ï¼Œå®¡è®¡ï¼Œæ£€æµ‹ä½ çš„æ‰€æœ‰ä¾èµ–æ˜¯å¦å®‰å…¨ã€‚`npm audit`/`yarn audit` å‡æœ‰æ•ˆã€‚

é€šè¿‡å®¡è®¡ï¼Œå¯çœ‹å‡ºæœ‰é£é™©çš„ `package`ã€ä¾èµ–åº“çš„ä¾èµ–é“¾ã€é£é™©åŸå› åŠå…¶è§£å†³æ–¹æ¡ˆã€‚

https://docs.npmjs.com/cli/v6/commands/npm-audit

```bash
$ npm audit
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ high          â”‚ Regular Expression Denial of Service in trim                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Package       â”‚ trim                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Patched in    â”‚ >=0.0.3                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dependency of â”‚ @mdx-js/loader                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Path          â”‚ @mdx-js/loader > @mdx-js/mdx > remark-mdx > remark-parse >   â”‚
â”‚               â”‚ trim                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ More info     â”‚ https://www.npmjs.com/advisories/1002775                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
76 vulnerabilities found - Packages audited: 1076
Severity: 49 Moderate | 27 High
âœ¨  Done in 4.60s.
```

ä»…é’ˆå¯¹ç”Ÿäº§ä¾èµ–å®¡è®¡

```bash
$ npm audit production

$ yarn audit dependencies
```

é€šè¿‡ `npm audit fix` å¯ä»¥è‡ªåŠ¨ä¿®å¤è¯¥åº“çš„é£é™©ï¼ŒåŸç†å°±æ˜¯å‡çº§ä¾èµ–åº“ï¼Œå‡çº§è‡³å·²ä¿®å¤äº†é£é™©çš„ç‰ˆæœ¬å·ã€‚

```bash
$ npm audit fix
```

`yarn audit` æ— æ³•è‡ªåŠ¨ä¿®å¤ï¼Œéœ€è¦ä½¿ç”¨ `yarn upgrade` æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬å·ï¼Œä¸å¤Ÿæ™ºèƒ½ã€‚

[synk](https://snyk.io/)æ˜¯ä¸€ä¸ªé«˜çº§ç‰ˆçš„ `npm audit`ï¼Œå¯è‡ªåŠ¨ä¿®å¤ï¼Œä¸”æ”¯æŒ CICD é›†æˆä¸å¤šç§è¯­è¨€ã€‚

```bash
$ npx snyk

$ npx wizard
```

#### github dependabot

å½“dependabotæ£€æµ‹åˆ°æœ‰é—®é¢˜æ—¶ï¼Œä¼šè‡ªåŠ¨å‘è¯¥ä»“åº“æäº¤ PRã€‚

##### å¼€å¯ Dependabot

- å¼€å¯æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œä»…éœ€å°† `dependabot.yml` é…ç½®æ–‡ä»¶æ”¾å…¥ä»“åº“çš„ `.github` ç›®å½•ä¸­å³å¯å¼€å¯ã€‚ä¹‹å Dependabot å°±ä¼šè‡ªåŠ¨æäº¤ PR æ¥æ›´æ–°æ‚¨é¡¹ç›®ä¸­çš„ä¾èµ–é¡¹äº†ã€‚

- æ‚¨ä¹Ÿå¯ä»¥åœ¨ GitHub é¡µé¢ä¸Šè¿›è¡Œæ“ä½œï¼Œåœ¨ä»“åº“é¡µé¢é€šè¿‡ `Insights` -> `Dependency graph` -> `Dependabot` -> `Enable Dependabot` è·¯å¾„å³å¯å¼€å¯ï¼Œä¹‹åå°±å¯ä»¥ç‚¹å‡» `Create config file` æ¥åˆ›å»ºé…ç½®æ–‡ä»¶äº†ã€‚

##### é…ç½® dependabot.yml

[å®˜æ–¹æ–‡æ¡£](https://docs.github.com/cn/code-security/dependabot/dependabot-version-updates/configuration-options-for-the-dependabot.yml-file#commit-message)

ä¾‹å­

```yaml
# Basic dependabot.yml file with
# minimum configuration for two package managers

version: 2
updates:
  # Enable version updates for npm
  - package-ecosystem: "npm"
    # Look for `package.json` and `lock` files in the `root` directory
    directory: "/"
    # Check the npm registry for updates every day (weekdays)
    schedule:
      interval: "daily"

  # Enable version updates for Docker
  - package-ecosystem: "docker"
    # Look for a `Dockerfile` in the `root` directory
    directory: "/"
    # Check for updates once a week
    schedule:
      interval: "weekly"
```

#### è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·

ä½¿ç”¨ `npm outdated` è™½èƒ½å‘ç°éœ€è¦å‡çº§ç‰ˆæœ¬å·çš„ packageï¼Œä½†ä»ç„¶éœ€è¦æ‰‹åŠ¨åœ¨ package.json æ›´æ”¹ç‰ˆæœ¬å·è¿›è¡Œå‡çº§ã€‚

æ­¤æ—¶æ¨èä¸€ä¸ªåŠŸèƒ½æ›´å¼ºå¤§çš„å·¥å…· `npm-check-updates`ï¼Œæ¯” `npm outdated` å¼ºå¤§ç™¾å€ã€‚

`npm-check-updates -u`ï¼Œå¯è‡ªåŠ¨å°† package.json ä¸­å¾…æ›´æ–°ç‰ˆæœ¬å·è¿›è¡Œé‡å†™ã€‚

å‡çº§ [minor] å°ç‰ˆæœ¬å·ï¼Œæœ‰å¯èƒ½å¼•èµ· `Break Change`ï¼Œå¯ä»…ä»…å‡çº§åˆ°æœ€æ–°çš„ patch ç‰ˆæœ¬ã€‚

```bash
$ npx npm-check-updates --target patch
```



### patch-package

ç»™npmåŒ…åœ¨æœ¬åœ°ç¯å¢ƒæ‰“è¡¥ä¸

å‡è®¾ `lodash` æœ‰ä¸€ä¸ª Bugï¼Œå½±å“çº¿ä¸Šå¼€å‘ï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ

ç­”: ä¸‰æ­¥èµ°ã€‚

1. åœ¨ Github æäº¤ Pull Requestï¼Œä¿®å¤ Bugï¼Œç­‰å¾…åˆå¹¶
2. åˆå¹¶ PR åï¼Œç­‰å¾…æ–°ç‰ˆæœ¬å‘åŒ…
3. å‡çº§é¡¹ç›®ä¸­çš„ lodash ä¾èµ–

å¾ˆåˆç†å¾ˆè§„èŒƒçš„ä¸€ä¸ªæµç¨‹ï¼Œä½†æ˜¯å®ƒä¸€ä¸ªæœ€å¤§çš„é—®é¢˜å°±æ˜¯ï¼Œå¤ªæ…¢äº†ï¼Œä¸‰æ­¥èµ°å®Œé»„èŠ±èœéƒ½å‡‰äº†ã€‚

æ­¤æ—¶å¯ç›´æ¥ä¸Šæ‰‹ä¿®æ”¹ `node_modules` ä¸­ lodash ä»£ç ï¼Œå¹¶ä¿®å¤é—®é¢˜ï¼

æ–°é—®é¢˜ï¼š`node_modules` æœªçº³å…¥ç‰ˆæœ¬ç®¡ç†ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒå¹¶æ²¡æœ‰ç”¨ã€‚è¯·çœ‹æµç¨‹

1. æœ¬åœ°ä¿®æ”¹ `node_modules/lodash`ï¼Œæœ¬åœ°æ­£å¸¸è¿è¡Œ âœ…
2. çº¿ä¸Š `npm i lodash`ï¼Œlodash æœªè¢«ä¿®æ”¹ï¼Œçº¿ä¸Šè¿è¡Œå¤±è´¥ âŒ

æ­¤æ—¶æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ¡ˆï¼Œä¸´æ—¶å°†ä¿®å¤æ–‡ä»¶çº³å…¥å·¥ä½œç›®å½•ï¼Œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜

1. æœ¬åœ°ä¿®æ”¹ `node_modules/lodash`ï¼Œæœ¬åœ°æ­£å¸¸è¿è¡Œ âœ…
2. å°†ä¿®æ”¹æ–‡ä»¶å¤åˆ¶åˆ° `${work_dir}/patchs/lodash` ä¸­ï¼Œçº³å…¥ç‰ˆæœ¬ç®¡ç†
3. çº¿ä¸Š `npm i lodash`ï¼Œå¹¶å°†ä¿®æ”¹æ–‡ä»¶å†åº¦å¤åˆ¶åˆ° `node_modules/lodash` ä¸­ï¼Œçº¿ä¸Šæ­£å¸¸è¿è¡Œ âœ…

ä½†æ­¤æ—¶å¹¶ä¸æ˜¯å¾ˆæ™ºèƒ½ï¼Œä¸”ç•¥æœ‰å°é—®é¢˜ï¼Œæ¼”ç¤ºå¦‚ä¸‹:

1. æœ¬åœ°ä¿®æ”¹ `node_modules/lodash`ï¼Œæœ¬åœ°æ­£å¸¸è¿è¡Œ âœ…
2. å°†ä¿®æ”¹æ–‡ä»¶å¤åˆ¶åˆ° `${work_dir}/patchs/lodash` ä¸­ï¼Œçº³å…¥ç‰ˆæœ¬ç®¡ç† âœ…
3. çº¿ä¸Š `npm i lodash`ï¼Œå¹¶å°†ä¿®æ”¹æ–‡ä»¶å†åº¦å¤åˆ¶åˆ° `node_modules/lodash` ä¸­ï¼Œçº¿ä¸Šæ­£å¸¸è¿è¡Œ âœ…
4. ä¸¤ä¸ªæœˆåå‡çº§ `lodash`ï¼Œè¯¥é—®é¢˜å¾—ä»¥è§£å†³ï¼Œè€Œæˆ‘ä»¬ä»£ç å¼•ç”¨äº† lodash çš„æ–°ç‰¹æ€§
5. çº¿ä¸Š `npm i lodash`ï¼Œå¹¶å°†ä¿®æ”¹æ–‡ä»¶å†åº¦å¤åˆ¶åˆ° `node_modules/lodash` ä¸­ï¼Œç”±äºå·²æ›´æ–°äº† lodashï¼Œå¹¶ä¸”ä¾èµ–äºæ–°ç‰¹æ€§ï¼Œçº¿ä¸Šè¿è¡Œå¤±è´¥ âŒ

æ­¤æ—¶æœ‰ä¸€ä¸ªä¸‡èƒ½ä¹‹ç­–ï¼Œé‚£å°±æ˜¯ [patch-package](https://github.com/ds300/patch-package)

æƒ³è¦çŸ¥é“ `patch-package` å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œè¯·å…ˆäº†è§£ä¸‹å®ƒçš„ç”¨æ³•ï¼Œæµç¨‹å¦‚ä¸‹

```bash
$ npm i -D patch-package
# åœ¨ package.json scripts å¢åŠ å‘½ä»¤ "postinstall":"patch-package"

# ä¿®æ”¹ lodash çš„ä¸€ä¸ªå°é—®é¢˜
$ vim node_modules/lodash/index.js

# å¯¹ lodash çš„ä¿®å¤ï¼Œç”Ÿæˆä¸€ä¸ª patch æ–‡ä»¶ï¼Œä½äº {workRoot}/patches/lodash+4.17.21.patch
$ npx patch-package lodash

# å°†ä¿®å¤æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬ç®¡ç†ä¹‹ä¸­
$ git add patches/lodash+4.17.21.patch
$ git commit -m "fix ä¸€ç‚¹å„¿å°äº‹ in lodash"

# å½“å…¶ä»–åŒäº‹æ‹‰åˆ°ä»£ç å¦‚ä½•åº”ç”¨è¡¥ä¸å‘¢ï¼Ÿè®©åŒäº‹æ‰§è¡Œ npm i

# æ­¤åçš„å‘½ä»¤åœ¨ç”Ÿäº§ç¯å¢ƒæˆ– CI ä¸­æ‰§è¡Œ
# æ­¤åçš„å‘½ä»¤åœ¨ç”Ÿäº§ç¯å¢ƒæˆ– CI ä¸­æ‰§è¡Œ
# æ­¤åçš„å‘½ä»¤åœ¨ç”Ÿäº§ç¯å¢ƒæˆ– CI ä¸­æ‰§è¡Œ

# åœ¨ç”Ÿäº§ç¯å¢ƒè£…åŒ…
$ npm i

# å¤§åŠŸå‘Šæˆï¼
```

`patch-package`åªä¼šå½“å‰ç‰ˆæœ¬ç”Ÿæ•ˆ

å¦‚æœä½ è£…çš„åŒ…ç‰ˆæœ¬å’Œä½ ä¹‹å‰ç”Ÿæˆçš„è¡¥ä¸ä¸­è®°å½•çš„ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œ`npx patch-package`ä¼šç›´æ¥æŠ¥é”™`**ERROR** Failed to apply patch for package xxxx at path`

### lock-file

**webåº”ç”¨çš„ç”Ÿäº§ç¯å¢ƒæ„å»ºéœ€è¦ lock-file é”å®šä¾èµ–ç‰ˆæœ¬**

å½“æˆ‘ä»¬åœ¨ `npm i` æŸä¸ªä¾èµ–æ—¶ï¼Œé»˜è®¤çš„ç‰ˆæœ¬å·æ˜¯æœ€æ–°ç‰ˆæœ¬å· `^1.2.3`ï¼Œä»¥ `^` å¼€å¤´å¯æœ€å¤§é™åº¦åœ°ä½¿ç”¨æ–°ç‰¹æ€§ï¼Œä½†æ˜¯æŸäº›åº“ä¸éµå¾ªè¯¥ä¾èµ–å¯èƒ½å‡ºç°é—®é¢˜ã€‚

> `^1.2.3` æŒ‡ >=1.2.3 <2.0.0

ä¸€ä¸ªé—®é¢˜: å½“é¡¹ç›®ä¸­æ²¡æœ‰ lock æ–‡ä»¶æ—¶ï¼Œç”Ÿäº§ç¯å¢ƒçš„é£é™©æ˜¯å¦‚ä½•äº§ç”Ÿçš„?

æ¼”ç¤ºé£é™©è¿‡ç¨‹å¦‚ä¸‹:

1. `pkg 1.2.3`: é¦–æ¬¡åœ¨å¼€å‘ç¯å¢ƒå®‰è£… pkg åº“ï¼Œä¸ºæ­¤æ—¶æœ€æ–°ç‰ˆæœ¬ `1.2.3`ï¼Œ`dependencies` ä¾èµ–ä¸­æ˜¾ç¤º `^1.2.3`ï¼Œå®é™…å®‰è£…ç‰ˆæœ¬ä¸º `1.2.3`
2. `pkg 1.19.0`: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸Šçº¿é¡¹ç›®ï¼Œå®‰è£… pkg åº“ï¼Œæ­¤æ—¶æœ€æ–°ç‰ˆæœ¬ä¸º `1.19.0`ï¼Œæ»¡è¶³ `dependencies` ä¸­ä¾èµ– `^1.2.3` èŒƒå›´ï¼Œå®é™…å®‰è£…ç‰ˆæœ¬ä¸º `1.19.0`ï¼Œ**ä½†æ˜¯ `pkg` æœªéµä» semver è§„èŒƒï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­å¼•å…¥äº† Breaking Changeï¼Œå¦‚ä½•æ­¤æ—¶ `1.19.0` æœ‰é—®é¢˜çš„è¯ï¼Œé‚£ç”Ÿäº§ç¯å¢ƒä¸­çš„ `1.19.0` å°†ä¼šå¯¼è‡´ bugï¼Œä¸”éš¾ä»¥è°ƒè¯•**

è€Œå½“æœ‰äº† lock æ–‡ä»¶æ—¶ï¼Œæ¯ä¸€ä¸ªä¾èµ–çš„ç‰ˆæœ¬å·éƒ½è¢«é”æ­»åœ¨äº† lock æ–‡ä»¶ï¼Œæ¯æ¬¡ä¾èµ–å®‰è£…çš„ç‰ˆæœ¬å·éƒ½ä» lock æ–‡ä»¶ä¸­è¿›è¡Œè·å–ï¼Œé¿å…äº†ä¸å¯æµ‹çš„ä¾èµ–é£é™©ã€‚

### é…ç½®æ–‡ä»¶ä¸ºä»€ä¹ˆé€šå¸¸æ˜¯rcç»“å°¾

https://stackoverflow.com/questions/11030552/what-does-rc-mean-in-dot-files

â€œrcâ€åç¼€å¯ä»¥è¿½æº¯åˆ°Unixçš„ç¥–çˆ¶æ¯CTSSã€‚å®ƒæœ‰ä¸€ä¸ªåä¸ºâ€œruncomâ€çš„å‘½ä»¤è„šæœ¬åŠŸèƒ½ã€‚æ—©æœŸçš„Unixä½¿ç”¨â€œrcâ€ä½œä¸ºæ“ä½œç³»ç»Ÿå¼•å¯¼è„šæœ¬çš„åç§°ï¼Œä»¥æ­¤å‘CTSS runcomè‡´æ•¬ã€‚



### ä½¿ç”¨ `TypeDoc` å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£å¹¶éƒ¨ç½²åˆ° GitHub pagesã€‚

